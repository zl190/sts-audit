
# Case 01: 书店系统 — 需求迭代下的架构应力实验

## 实验目的

在**同一 prompt 中同时生成** H 级和 Z 级两个对照版本，然后施加相同的需求变更压力，
观察两种架构在迭代时的 CC / ADF 退化差异。

## Prompt 序列

### Step 1: 同时生成 H/Z 对照底座 (v1)

> 请为我生成两个版本的 Python 代码，实现一个简单的'在线书店订单处理系统'。
>
> H 级版本（高耦合）： 将 UI 显示、折扣逻辑、数据库保存全部写在一个大类 OrderProcessor 的 process() 方法里，大量使用内嵌 if-else 处理不同类型的书籍和折扣。
>
> Z 级版本（解耦）： 使用'策略模式'处理折扣，使用'观察者模式'处理通知，UI 与逻辑完全分离。
>
> 请确保两个版本的功能完全一致。

**产出：** `H_v1_mono.py` + `Z_v1_mono.py`

### Step 2: 施加需求迭代压力 (v1 → v2)

> 现在需求变了：我们需要增加一个功能——'如果是电子书且价格超过 100 元，需要额外发送一封激活码邮件，并给予 5% 的特殊折扣'。请分别修改这两个版本的代码以实现此功能。

**产出：** `H_v2_mono.py` + `Z_v2_mono.py`

### Step 3: 物理拆分（实验者手动执行）

将 `Z_v2_mono.py` 手动拆分为 `Z_v2_split/service.py` + `Z_v2_split/views.py`，
验证物理隔离对 ADF 的影响。
